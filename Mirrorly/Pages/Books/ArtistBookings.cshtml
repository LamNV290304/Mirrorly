@page
@model ArtistBookingsModel

<section class="booking-status">
	<h2>Artist – Booking List</h2>

	<div class="status-list">
		@if (!string.IsNullOrEmpty(Model.Message))
		{
			<div class="alert-success">@Model.Message</div>
		}
		@if (!string.IsNullOrEmpty(Model.Error))
		{
			<div class="alert-error">@Model.Error</div>
		}

		@foreach (var booking in Model.Books)
		{
			string cssClass = booking.Status switch
			{
				1 => "confirmed",
				2 => "pending",
				3 => "cancelled",
				_ => "pending"
			};

			<div class="status-card @cssClass">
				<div class="status-info">
					<h3>@booking.Customer.DisplayName</h3>
					<p><strong>Phone Number:</strong> @booking.Customer.PhoneNumber</p>
					<p><strong>Service:</strong> @booking.Service.Name</p>
					<p><strong>Date:</strong> @booking.ScheduledStart:dd/MM/yyyy</p>
					<p><strong>Time:</strong> @booking.TimeM</p>
					<p><strong>Address:</strong> @booking.AddressLine</p>
					<p><strong>Notes:</strong> @booking.Notes</p>
				</div>

				<div class="status-footer">
					<span class="status-label">
						@(booking.Status == 1 ? "CONFIRMED" :
													booking.Status == 2 ? "PENDING" :
													booking.Status == 3 ? "CANCELLED" : "UNKNOWN")
					</span>

					@if (booking.Status == 2)
						{
						<div class="actions">
							@if (booking.Status == 2)
							{
								<form method="post" asp-page-handler="UpdateStatus" asp-route-bookingId="@booking.BookingId">
									<input type="hidden" name="status" value="1" />
									<button type="submit" class="btn-accept"
											onclick="return confirm('Bạn có chắc muốn xác nhận booking này không?');">
										Accept
									</button>
								</form>
							}

						<form method="post" asp-page-handler="UpdateStatus" asp-route-bookingId="@booking.BookingId">
							<input type="hidden" name="status" value="3" />
							<button type="submit" class="btn-cancel"
									onclick="return confirm('Bạn có chắc muốn hủy booking này không?');">
								Cancel
							</button>
						</form>
					</div>
					}

				</div>
			</div>
		}
	</div>
</section>
